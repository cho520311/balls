<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ–°ç«¹ä¹‹æ—…åœ˜è³¼ç¶² - å—æ¸¯ç¤¾å¤§</title>
    <style>
        :root { --travel-blue: #2e59a7; --classic-red: #a93226; --warm-bg: #fdfaf5; }
        body { font-family: "Microsoft JhengHei", sans-serif; background-color: #e9ecef; margin: 0; padding: 15px; }
        .container { max-width: 850px; background: white; padding: 25px; border-radius: 15px; box-shadow: 0 5px 25px rgba(0,0,0,0.2); margin: auto; border-top: 10px solid var(--travel-blue); }
        .header-section { text-align: center; margin-bottom: 20px; }
        .order-box { background: var(--warm-bg); border: 2px solid #ddd; padding: 20px; border-radius: 12px; margin-bottom: 30px; }
        #userName { width: 100%; padding: 12px; font-size: 18px; border: 2px solid var(--travel-blue); border-radius: 8px; box-sizing: border-box; margin: 10px 0 20px 0; }
        .item-card { background: white; border: 1px solid #eee; padding: 12px; border-radius: 8px; display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        select { width: 80px; height: 45px; font-size: 18px; border: 2px solid var(--travel-blue); border-radius: 5px; }
        .add-btn { width: 100%; padding: 18px; background: var(--travel-blue); color: white; border: none; border-radius: 8px; font-size: 22px; cursor: pointer; font-weight: bold; }
        
        /* å¯¦æ™‚æ¸…å–®å€åŸŸæ¨£å¼ */
        .live-list-section { margin-top: 40px; border-top: 2px solid #eee; padding-top: 20px; }
        .list-title { color: var(--classic-red); font-size: 22px; font-weight: bold; text-align: center; margin-bottom: 15px; }
        .iframe-container { width: 100%; overflow: hidden; border: 1px solid #ccc; border-radius: 8px; }
        iframe { width: 100%; height: 400px; border: none; }
        
        .footer-quote { text-align: center; margin-top: 30px; font-size: 22px; color: var(--classic-red); font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <div class="header-section">
        <h1>ğŸš æ–°ç«¹ä¹‹æ—…åœ˜è³¼ç¶² ğŸš</h1>
        <p style="font-weight:bold; color:var(--travel-blue);">å¯’å‡æ¼«éŠ Â· å°‹å‘³é¢¨åŸ</p>
    </div>

    <div class="order-box">
        <label>ğŸ‘¤ è«‹è¼¸å…¥å§“åï¼š</label>
        <input type="text" id="userName" placeholder="è«‹è¼¸å…¥ä¸­æ–‡å…¨å">
        
        <div id="menu">
            <div class="item-card"><span>åŒ…é¤¡é­šä¸¸ (170å…ƒ)</span><select class="qty" data-name="åŒ…é¤¡é­šä¸¸" data-price="170"><script>for(let i=0;i<=5;i++) document.write(`<option value="${i}">${i}</option>`)</script></select></div>
            <div class="item-card"><span>ç„¡åŒ…é¤¡é­šä¸¸ (150å…ƒ)</span><select class="qty" data-name="ç„¡åŒ…é¤¡é­šä¸¸" data-price="150"><script>for(let i=0;i<=5;i++) document.write(`<option value="${i}">${i}</option>`)</script></select></div>
            <div class="item-card"><span>åŸå‘³è²¢ä¸¸ (190å…ƒ)</span><select class="qty" data-name="åŸå‘³è²¢ä¸¸" data-price="190"><script>for(let i=0;i<=5;i++) document.write(`<option value="${i}">${i}</option>`)</script></select></div>
            <div class="item-card"><span>é¦™è‡è²¢ä¸¸ (190å…ƒ)</span><select class="qty" data-name="é¦™è‡è²¢ä¸¸" data-price="190"><script>for(let i=0;i<=5;i++) document.write(`<option value="${i}">${i}</option>`)</script></select></div>
            <div class="item-card"><span>ç¦å·ç‡•ä¸¸ (220å…ƒ)</span><select class="qty" data-name="ç¦å·ç‡•ä¸¸" data-price="220"><script>for(let i=0;i<=5;i++) document.write(`<option value="${i}">${i}</option>`)</script></select></div>
            <div class="item-card"><span>é®®è”¥è²¢ä¸¸ (220å…ƒ)</span><select class="qty" data-name="é®®è”¥è²¢ä¸¸" data-price="220"><script>for(let i=0;i<=5;i++) document.write(`<option value="${i}">${i}</option>`)</script></select></div>
        </div>
        
        <button class="add-btn" id="submitBtn" onclick="submitToGAS()">ç¢ºèªé€å‡ºè¨‚å–®</button>
        <p id="msg" style="text-align:center; display:none;">âŒ› æ­£åœ¨å‚³é€è³‡æ–™...</p>
    </div>

    <div class="live-list-section">
        <div class="list-title">ğŸ“‹ å·²ç™»è¨˜åŒå­¸åå–®</div>
        <div class="iframe-container">
            <iframe src="https://docs.google.com/spreadsheets/d/1VKY2nnZuHN2NjHEhdELU1QJOZIvTfWfed0Bd8aXwtdo/edit?usp=sharing"></iframe>
        </div>
        <p style="font-size: 14px; color: #888; text-align: center;">(è³‡æ–™ç´„æœ‰ 1-3 åˆ†é˜å»¶é²ï¼Œè‹¥æ²’çœ‹åˆ°è«‹é‡æ–°æ•´ç†ç¶²é )</p>
    </div>

    <div class="footer-quote">å¯’ç›¡æ˜¥ç”ŸéŠå¤è¹Ÿï¼Œå¸«å¾’æƒ…èª¼æ°¸ç•™å¿ƒã€‚</div>
</div>

<script>
    async function submitToGAS() {
        const name = document.getElementById('userName').value.trim();
        const gasUrl = 'https://script.google.com/macros/s/AKfycbytpwemg89R6_ErsARHEAyWuSTPmRQhaWNFVXYNZAuEEeF1HA62SpgNkULpxlpZkYRNaw/exec'; // â˜…è«‹ç¢ºä¿é€™è£¡æ˜¯ /exec çµå°¾çš„ç¶²å€
        
        if (!name) { alert("è«‹è¼¸å…¥å§“å"); return; }
        
        let details = [];
        let total = 0;
        document.querySelectorAll('.qty').forEach(s => {
            const q = parseInt(s.value);
            if(q > 0) {
                const p = s.getAttribute('data-name');
                const price = parseInt(s.getAttribute('data-price'));
                details.push(`${p}x${q}`);
                total += (q * price);
            }
        });

        if (details.length === 0) { alert("è«‹é¸æ“‡æ•¸é‡"); return; }

        const btn = document.getElementById('submitBtn');
        btn.disabled = true;
        document.getElementById('msg').style.display = 'block';

        try {
            await fetch(gasUrl, {
                method: 'POST',
                mode: 'no-cors',
                body: JSON.stringify({ name: name, orderString: details.join(', '), total: total })
            });
            alert("ğŸ‰ è¨‚è³¼æˆåŠŸï¼");
            location.reload(); 
        } catch (e) {
            alert("éŒ¯èª¤ï¼Œè«‹å†è©¦ä¸€æ¬¡");
            btn.disabled = false;
        }
    }
</script>
</body>
</html>




