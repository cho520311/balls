<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ–°ç«¹ä¹‹æ—…åœ˜è³¼ç¶² - å—æ¸¯ç¤¾å¤§</title>
    <style>
        :root { --travel-blue: #2e59a7; --classic-red: #a93226; --warm-bg: #fdfaf5; }
        body { font-family: "Microsoft JhengHei", sans-serif; background-color: #e9ecef; margin: 0; padding: 15px; }
        .container { max-width: 800px; background: white; padding: 25px; border-radius: 15px; box-shadow: 0 5px 25px rgba(0,0,0,0.2); margin: auto; border-top: 10px solid var(--travel-blue); }
        .header-section { text-align: center; margin-bottom: 20px; }
        .trip-info { background: #f9f9f9; padding: 15px; border-radius: 10px; font-size: 16px; line-height: 1.6; color: #444; margin-bottom: 20px; border-left: 5px solid var(--travel-blue); }
        .order-box { background: var(--warm-bg); border: 2px solid #ddd; padding: 20px; border-radius: 12px; }
        #userName { width: 100%; padding: 12px; font-size: 18px; border: 2px solid var(--travel-blue); border-radius: 8px; box-sizing: border-box; margin: 10px 0 20px 0; }
        .item-card { background: white; border: 1px solid #eee; padding: 12px; border-radius: 8px; display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        select { width: 80px; height: 45px; font-size: 18px; border: 2px solid var(--travel-blue); border-radius: 5px; background: white; }
        .add-btn { width: 100%; padding: 18px; background: var(--travel-blue); color: white; border: none; border-radius: 8px; font-size: 22px; cursor: pointer; font-weight: bold; transition: 0.2s; }
        .add-btn:disabled { background: #ccc; cursor: not-allowed; }
        .footer-quote { text-align: center; margin-top: 30px; font-size: 22px; color: var(--classic-red); font-weight: bold; }
        #msg { text-align: center; font-weight: bold; margin-top: 10px; display: none; color: var(--travel-blue); }
    </style>
</head>
<body>

<div class="container">
    <div class="header-section">
        <h1>ğŸš æ–°ç«¹ä¹‹æ—…åœ˜è³¼ç¶² ğŸš</h1>
        <p style="font-weight:bold; color:var(--travel-blue); font-size: 20px;">å¯’å‡æ¼«éŠ Â· å°‹å‘³é¢¨åŸ</p>
    </div>

    <div class="trip-info">
        æ‡·æ£è‘—å°åœŸåœ°çš„ç†±æ„›èˆ‡å­¸ç¿’çš„ç†±å¿±ï¼Œ<b>å—æ¸¯ç¤¾å¤§ç¶ å¾‘æ¼«éŠç­</b>å¸«ç”Ÿå¥½å‹ï¼Œè®“æˆ‘å€‘åœ¨å¯’å‡æ¢è¨ªå¤è¹Ÿä¹‹é¤˜ï¼Œä¸€èµ·å¸¶å›æ–°ç«¹çŸ³å®¶é­šä¸¸çš„é“åœ°ç¾å‘³ã€‚
    </div>
    
    <div class="order-box">
        <label style="font-weight: bold; font-size: 18px;">ğŸ‘¤ ç¬¬ä¸€æ­¥ï¼šè«‹è¼¸å…¥ä¸­æ–‡å…¨å</label>
        <input type="text" id="userName" placeholder="ç¯„ä¾‹ï¼šç‹å°æ˜">
        
        <label style="font-weight: bold; font-size: 18px;">ğŸ“¦ ç¬¬äºŒæ­¥ï¼šé¸æ“‡è¨‚è³¼æ•¸é‡</label>
        <div id="menu" style="margin-top: 10px;">
            <div class="item-card"><span>åŒ…é¤¡é­šä¸¸ (170å…ƒ)</span><select class="qty" data-name="åŒ…é¤¡é­šä¸¸" data-price="170"><script>for(let i=0;i<=10;i++) document.write(`<option value="${i}">${i}</option>`)</script></select></div>
            <div class="item-card"><span>ç„¡åŒ…é¤¡é­šä¸¸ (150å…ƒ)</span><select class="qty" data-name="ç„¡åŒ…é¤¡é­šä¸¸" data-price="150"><script>for(let i=0;i<=10;i++) document.write(`<option value="${i}">${i}</option>`)</script></select></div>
            <div class="item-card"><span>åŸå‘³è²¢ä¸¸ (190å…ƒ)</span><select class="qty" data-name="åŸå‘³è²¢ä¸¸" data-price="190"><script>for(let i=0;i<=10;i++) document.write(`<option value="${i}">${i}</option>`)</script></select></div>
            <div class="item-card"><span>é¦™è‡è²¢ä¸¸ (190å…ƒ)</span><select class="qty" data-name="é¦™è‡è²¢ä¸¸" data-price="190"><script>for(let i=0;i<=10;i++) document.write(`<option value="${i}">${i}</option>`)</script></select></div>
            <div class="item-card"><span>ç¦å·ç‡•ä¸¸ (220å…ƒ)</span><select class="qty" data-name="ç¦å·ç‡•ä¸¸" data-price="220"><script>for(let i=0;i<=10;i++) document.write(`<option value="${i}">${i}</option>`)</script></select></div>
            <div class="item-card"><span>é®®è”¥è²¢ä¸¸ (220å…ƒ)</span><select class="qty" data-name="é®®è”¥è²¢ä¸¸" data-price="220"><script>for(let i=0;i<=10;i++) document.write(`<option value="${i}">${i}</option>`)</script></select></div>
        </div>
        
        <button class="add-btn" id="submitBtn" onclick="submitToGAS()">ç¢ºèªé€å‡ºè¨‚å–®</button>
        <p id="msg">â³ æ­£åœ¨å‚³é€åˆ°é›²ç«¯è©¦ç®—è¡¨ï¼Œè«‹ç¨å€™...</p>
    </div>

    <div class="footer-quote">å¯’ç›¡æ˜¥ç”ŸéŠå¤è¹Ÿï¼Œå¸«å¾’æƒ…èª¼æ°¸ç•™å¿ƒã€‚</div>
</div>

<script>
    async function submitToGAS() {
        const nameInput = document.getElementById('userName');
        const name = nameInput.value.trim();
        
        // â˜…â˜…â˜… ç¬¬ 89 è¡Œï¼šè«‹å°‡ä¸‹æ–¹çš„å¼•è™Ÿå…§å®¹æ›¿æ›ç‚ºæ‚¨çš„ GAS ç¶²å€ â˜…â˜…â˜…
        const gasUrl = 'https://script.google.com/macros/s/AKfycbxX-4LAifqTJCUuxXh8JRPPsTaS04jrI-l8xbkbe6ZFNPR1ms5U85EE3NfScbeqlzjhJg/exec'; 
        
        if (!name) { alert("è«‹å…ˆè¼¸å…¥æ‚¨çš„å§“åï¼"); return; }
        
        let total = 0;
        let details = [];
        document.querySelectorAll('.qty').forEach(s => {
            const q = parseInt(s.value);
            if(q > 0) {
                const p = s.getAttribute('data-name');
                const price = parseInt(s.getAttribute('data-price'));
                details.push(`${p}x${q}`);
                total += (q * price);
            }
        });

        if (details.length === 0) { alert("è«‹è‡³å°‘é¸æ“‡ä¸€å€‹å“é …ï¼"); return; }

        const btn = document.getElementById('submitBtn');
        const msg = document.getElementById('msg');
        btn.disabled = true;
        msg.style.display = 'block';

        const payload = {
            name: name,
            orderString: details.join(', '),
            total: total
        };

        try {
            // ä½¿ç”¨ no-cors æ¨¡å¼ç¢ºä¿è³‡æ–™é€å‡ºè‡³ Google Apps Script
            await fetch(gasUrl, {
                method: 'POST',
                mode: 'no-cors',
                cache: 'no-cache',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });
            
            alert("ğŸ‰ è¨‚è³¼æˆåŠŸï¼è³‡æ–™å·²å¯«å…¥è€å¸«çš„è©¦ç®—è¡¨ã€‚");
            // æ¸…é™¤è¼¸å…¥
            nameInput.value = '';
            document.querySelectorAll('.qty').forEach(s => s.value = 0);
            btn.disabled = false;
            msg.style.display = 'none';
        } catch (e) {
            console.error(e);
            alert("âš ï¸ å‚³é€å¤±æ•—ï¼Œè«‹è¯ç¹«è€å¸«æª¢æŸ¥å¾Œå°è¨­å®šã€‚");
            btn.disabled = false;
            msg.style.display = 'none';
        }
    }
</script>
</body>
</html>